<meta name="description" content="Learn drums with tailored lessons, record in a professional studio, or get expert drum care in Cairns, Australia." />
 
<!-- Firebase core (global) -->
<script src="https://www.gstatic.com/firebasejs/12.6.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.6.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.6.0/firebase-functions-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.6.0/firebase-storage-compat.js"></script>


<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDfiWX_TGcCopulONaTFBIaPb7ZRAiC_dc",
    authDomain: "dave-drums.firebaseapp.com",
    projectId: "dave-drums",
    storageBucket: "dave-drums.firebasestorage.app",
    messagingSenderId: "602823096344",
    appId: "1:602823096344:web:b6402156a4d1c16a21ab6d",
    measurementId: "G-RHL1DSNTJ7"
  };
  if (!firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
  }
</script>

<script>
<!-- Global Toast Notification System -->
window.VaultToast = (function(){
  var container = null;
  
  function init(){
    if(container) return;
    container = document.createElement('div');
    container.id = 'vault-toast-container';
    container.style.cssText = 'position:fixed;top:20px;right:20px;z-index:999999;pointer-events:none;';
    document.body.appendChild(container);
  }
  
  function show(message, type){
    init();
    
    type = type || 'success';
    var colors = {
      success: '#10b981',
      error: '#ef4444',
      info: '#3b82f6'
    };
    
    var toast = document.createElement('div');
    toast.style.cssText = 
      'background:' + colors[type] + ';' +
      'color:#fff;' +
      'padding:12px 20px;' +
      'border-radius:8px;' +
      'margin-bottom:10px;' +
      'box-shadow:0 4px 12px rgba(0,0,0,.15);' +
      'pointer-events:auto;' +
      'animation:slideIn 0.3s ease;' +
      'font-size:14px;' +
      'max-width:300px;';
    toast.textContent = message;
    
    container.appendChild(toast);
    
    setTimeout(function(){ 
      toast.style.animation = 'slideOut 0.3s ease';
      setTimeout(function(){ toast.remove(); }, 300);
    }, 2500);
  }
  
  return {
    success: function(msg){ show(msg, 'success'); },
    error: function(msg){ show(msg, 'error'); },
    info: function(msg){ show(msg, 'info'); }
  };
})();
</script>

<style>
@keyframes slideIn {
  from { transform: translateX(400px); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}
@keyframes slideOut {
  from { transform: translateX(0); opacity: 1; }
  to { transform: translateX(400px); opacity: 0; }
}
</style>

<!-- Vault renderer config + loader -->
<script src="https://dave-drums.github.io/vault/vault-render.js" defer></script>
<script>
  window.VAULT_CONFIG = {
    bunnyLibraryId: "556221",
    grooveOrigin: "https://groove.davedrums.com.au",
    grooveEmbedPath: "/GrooveEmbed.html",
    youtubeLogoSrc: "/s/youtube-logo.png"
  };
</script>



<!-- VAULT RENDER STYLING -->

<style>
:root{
  --vault-bubble-bg:#f0f0f0;
  --vault-max: 860px;
}

.vault-seq{ width:100%; }

/* VIDEO */
.vault-video-wrapper{
  width:min(var(--vault-max),100%);
  margin:0 auto;
}
.vault-video-embed{
  position:relative;
  padding-top:56.25%;
  border-radius:12px;
  overflow:hidden;
  background:#000;
  box-shadow:0 2px 8px rgba(0,0,0,0.06);
}
.vault-video-embed iframe{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  border:0;
}

/* TEXT (T>) */
.vault-info{
  padding:1rem 1.25rem;
  border-radius:12px;
  background:var(--vault-bubble-bg);
  box-sizing:border-box;
  text-align:center;
  line-height:1.4;
  font-size:inherit;
}

.vault-info-full{
  width:min(var(--vault-max),100%);
  margin:1rem auto 0;
}

.vault-info-row{
  width:min(var(--vault-max),100%);
  margin:1rem auto 0;
  display:flex;
  gap:1rem;
  align-items:stretch;
}

.vault-info-main{
  flex:1 1 auto;
  display:flex;
  flex-direction:column;
  justify-content:center;
}

.vault-info-yt{
  flex:0 0 170px;
  display:flex;
  align-items:center;
  justify-content:center;
  border:0;
  border-radius:12px;
  background:var(--vault-bubble-bg);
  cursor:pointer;
  padding:0.75rem 1rem;
}

.vault-yt-logo{
  max-height:22px;
  width:auto;
  display:block;
}

/* MOBILE STACK — MATCH TEXT BUBBLE PADDING */
@media (max-width:640px){
  .vault-info-row{
    flex-direction:column;
  }

  .vault-info-yt{
    flex:0 0 auto;
    width:100%;
    padding:1rem 1.25rem;   /* MATCH .vault-info */
  }
}

/* GROOVE (G>) */
.vault-groove-wrap{
  width:min(var(--vault-max),100%);
  margin:0 auto;
}

.vault-groove-player{
  width:100%;
  margin:0;
  padding:0.75rem;
  background:#fff;
  border:1px solid #e0e0e0;
  border-radius:12px;
  box-shadow:0 2px 8px rgba(0,0,0,0.06);
  box-sizing:border-box;
  overflow:visible;
}

.vault-groove-player iframe{
  width:100%;
  border:0;
  display:block;
  border-radius:8px;
  height:150px;
}

/* AUDIO */
.vault-audio-wrap{
  width:min(var(--vault-max),100%);
  margin:1rem auto 0;
}
.vault-audio{
  padding:1rem 1.25rem;
  border-radius:12px;
  background:var(--vault-bubble-bg);
  box-sizing:border-box;
}
.vault-audio-title{
  font-weight:600;
  margin-bottom:0.5rem;
}

/* HEADING + DIVIDER */
.vault-heading{
  width:min(var(--vault-max),100%);
  margin:2rem auto 0.75rem;
  font-weight:700;
  font-size:1.25em;
  color:#111;
}
.vault-divider{
  width:min(var(--vault-max),100%);
  height:1px;
  background:rgba(0,0,0,0.15);
  margin:2rem auto;
}

/* BR spacer */
.vault-spacer{ width:100%; }

/* YouTube lightbox */
.vault-yt-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.7);
  z-index:999999;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:1rem;
  box-sizing:border-box;
}
.vault-yt-inner{
  width:100%;
  max-width:900px;
  background:#000;
  border-radius:12px;
  overflow:hidden;
  position:relative;
}
.vault-yt-iframe-wrap{
  position:relative;
  padding-top:56.25%;
}
.vault-yt-iframe-wrap iframe{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  border:0;
}
.vault-yt-close{
  position:absolute;
  top:6px;
  right:10px;
  background:rgba(0,0,0,0.6);
  border:0;
  color:#fff;
  font-size:28px;
  line-height:1;
  padding:0 10px 6px;
  cursor:pointer;
  border-radius:6px;
  z-index:2;
}
</style>


<!-- VAULT RENDER STYLING end -->


<!-- Side Nav for Logged-in Users -->
<style>
#vault-side-nav-toggle {
  position: fixed;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(40, 40, 40, 0.7);
  backdrop-filter: blur(10px);
  border: none;
  border-radius: 8px 0 0 8px;
  padding: 12px 8px;
  cursor: pointer;
  z-index: 9998;
  color: #fff;
  font-size: 18px;
  display: none;
  transition: background 0.2s;
}
#vault-side-nav-toggle:hover {
  background: rgba(40, 40, 40, 0.85);
}
body.vault-logged-in #vault-side-nav-toggle {
  display: block;
}
#vault-side-nav {
  position: fixed;
  right: -250px;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(40, 40, 40, 0.7);
  backdrop-filter: blur(10px);
  border-radius: 12px 0 0 12px;
  padding: 16px;
  z-index: 9999;
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  width: 220px;
  transition: right 0.3s ease;
  font-family: inherit;
}
#vault-side-nav.open {
  right: 0;
}
#vault-side-nav a,
#vault-side-nav button {
  display: block;
  color: #fff;
  text-decoration: none;
  padding: 10px 14px;
  margin: 4px 0;
  border-radius: 8px;
  font-size: inherit;
  white-space: nowrap;
  transition: background 0.2s;
  background: none;
  border: none;
  cursor: pointer;
  text-align: left;
  width: 100%;
  font-family: inherit;
}
#vault-side-nav a:hover,
#vault-side-nav button:hover {
  background: rgba(255,255,255,0.1);
}
#vault-side-nav a.active {
  background: #06b3fd;
}
#vault-side-nav hr {
  border: none;
  border-top: 1px solid rgba(255,255,255,0.2);
  margin: 8px 0;
}
@media (max-width: 768px) {
  #vault-side-nav {
    width: 200px;
    right: -220px;
  }
}
</style>
<script>
(function(){
  if(typeof firebase === 'undefined') return;
  
  var auth = firebase.auth();
  var db = firebase.firestore();
  
  auth.onAuthStateChanged(function(user){
    if(user){
      document.body.classList.add('vault-logged-in');
      createSideNav(user.uid);
    } else {
      document.body.classList.remove('vault-logged-in');
      var nav = document.getElementById('vault-side-nav');
      var toggle = document.getElementById('vault-side-nav-toggle');
      if(nav) nav.remove();
      if(toggle) toggle.remove();
    }
  });
  
  function createSideNav(uid){
    var existing = document.getElementById('vault-side-nav');
    var existingToggle = document.getElementById('vault-side-nav-toggle');
    if(existing) existing.remove();
    if(existingToggle) existingToggle.remove();
    
    var toggle = document.createElement('button');
    toggle.id = 'vault-side-nav-toggle';
    toggle.innerHTML = '☰';
    toggle.setAttribute('aria-label', 'Toggle navigation');
    document.body.appendChild(toggle);
    
    var nav = document.createElement('div');
    nav.id = 'vault-side-nav';
    
    var links = [
      {text: 'Practice Vault', url: '/vault'},
      {text: 'Continue...', url: '/vault', id: 'vault-continue'},
      {text: 'GrooveScribe', url: '/groove'},
      {text: 'Members Area', url: '/members'}
    ];
    
    links.forEach(function(link){
      var a = document.createElement('a');
      a.href = link.url;
      a.textContent = link.text;
      if(link.id) a.id = link.id;
      nav.appendChild(a);
    });
    
    var hr = document.createElement('hr');
    nav.appendChild(hr);
    
    var logoutBtn = document.createElement('button');
    logoutBtn.textContent = 'Logout';
    logoutBtn.onclick = function(){
      auth.signOut().then(function(){
        window.location.href = '/members';
      });
    };
    nav.appendChild(logoutBtn);
    
    document.body.appendChild(nav);
    
    toggle.onclick = function(){
      nav.classList.toggle('open');
    };
    
    document.addEventListener('click', function(e){
      if(!nav.contains(e.target) && e.target !== toggle){
        nav.classList.remove('open');
      }
    });
    
    loadLastLesson(uid);
    highlightActive();
  }
  
  function loadLastLesson(uid){
    db.collection('users').doc(uid).collection('metrics').doc('practice').get()
      .then(function(snap){
        var continueLink = document.getElementById('vault-continue');
        if(!continueLink) return;
        
        if(!snap.exists){
          continueLink.style.display = 'none';
          return;
        }
        
        var data = snap.data() || {};
        var url = data.lastLessonUrl;
        var title = data.lastLessonTitle || '';
        
        if(url && title){
          if(title.length > 20) title = title.substring(0, 20) + '...';
          continueLink.textContent = 'Continue: ' + title;
          continueLink.href = url;
          continueLink.style.display = 'block';
        } else {
          continueLink.style.display = 'none';
        }
      })
      .catch(function(){
        var continueLink = document.getElementById('vault-continue');
        if(continueLink) continueLink.style.display = 'none';
      });
  }
  
  function highlightActive(){
    var path = window.location.pathname;
    var nav = document.getElementById('vault-side-nav');
    if(!nav) return;
    
    var links = nav.querySelectorAll('a');
    links.forEach(function(link){
      var href = link.getAttribute('href');
      if(href && href.indexOf('http') === -1 && path.indexOf(href) === 0 && href !== '/'){
        link.classList.add('active');
      }
    });
  }
})();
</script>
